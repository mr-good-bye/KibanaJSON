{
  "_index": "filebeat-7.12.0-2022.07.08-000015",
  "_type": "_doc",
  "_id": "kmVSOoIB5qdh9npSWnDF",
  "_version": 1,
  "_score": null,
  "_source": {
    "@timestamp": "2022-07-26T11:43:55.759Z",
    "log": {
      "file": {
        "path": "/var/log/pmpractice/backend/ApiTechLog/ApiTeachLog-20220726.txt"
      },
      "offset": 10487123
    },
    "message": "{\"ExceptionReceived\":{\"ClassName\":\"Npgsql.PostgresException\",\"Message\":\"P0001: Сотрудник 0 не найден\",\"Data\":{\"Severity\":\"ОШИБКА\",\"InvariantSeverity\":\"ERROR\",\"SqlState\":\"P0001\",\"MessageText\":\"Сотрудник 0 не найден\",\"Hint\":\"Вероятно пользователь не зарегистрирован в системе\",\"Where\":\"функция PL/pgSQL cards_system.getaccesswithprofilefromcache(integer,bigint,integer,character varying,integer,character varying,character varying,boolean), строка 9, оператор RAISE\\nфункция PL/pgSQL cards_system.getaccesswithprofilebysysname(character varying,bigint,character varying,character varying,integer,character varying,character varying,boolean), строка 71, оператор RETURN QUERY\",\"File\":\"pl_exec.c\",\"Line\":\"3178\",\"Routine\":\"exec_stmt_raise\"},\"InnerException\":null,\"HelpURL\":null,\"StackTraceString\":\"   at Npgsql.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|194_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\\n   at Npgsql.NpgsqlDataReader.<>c__DisplayClass41_0.<<ReadMessage>g__ReadMessageSequential|0>d.MoveNext()\\n--- End of stack trace from previous location where exception was thrown ---\\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\\n   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 418\\n   at PMPractice.Cards.Access.Repository.CardsAccessRepositoryPostgreSql.GetAccessWithProfileBySysNameAsync(Int64 userId, String cardType, String cardCode, Nullable`1 stateId, String elementType, IEnumerable`1 elementsId, String profileInputFields, Boolean noProfile) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/InformationSecurityTools/src/PMPractice.Cards.Access/Repository/CardsAccessReposutoryPostgreSql.cs:line 77\\n   at PMPractice.Cards.Access.Repository.CardsAccessControl.GetAccessWithProfileBySysNameAsync(GetAccessWithProfileBySysNameParams accessRequest) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/InformationSecurityTools/src/PMPractice.Cards.Access/Repository/CardsAccessControl.cs:line 105\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetAccess(String cardCode, String cardType, Int32 stateId, Int32 versionId, String userAccount) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 829\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetFieldsAsync(GetFieldsArgs args, String userAccount, Boolean isSaveCard, Boolean useAccess) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 323\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetFieldsAsync(GetFieldsArgs args, String userAccount, Boolean isSaveCard, Boolean useAccess) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 466\\n   at PMPractice.Cards.Controllers.FieldController.CardsFieldController.GetFieldsAsync(GetFieldsArgs args) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Controllers/FieldController/CardsFieldController.cs:line 46\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\",\"RemoteStackTraceString\":null,\"RemoteStackIndex\":0,\"ExceptionMethod\":null,\"HResult\":-2147467259,\"Source\":\"Npgsql\",\"WatsonBuckets\":null,\"Severity\":\"ОШИБКА\",\"InvariantSeverity\":\"ERROR\",\"SqlState\":\"P0001\",\"MessageText\":\"Сотрудник 0 не найден\",\"Detail\":null,\"Hint\":\"Вероятно пользователь не зарегистрирован в системе\",\"Position\":0,\"InternalPosition\":0,\"InternalQuery\":null,\"Where\":\"функция PL/pgSQL cards_system.getaccesswithprofilefromcache(integer,bigint,integer,character varying,integer,character varying,character varying,boolean), строка 9, оператор RAISE\\nфункция PL/pgSQL cards_system.getaccesswithprofilebysysname(character varying,bigint,character varying,character varying,integer,character varying,character varying,boolean), строка 71, оператор RETURN QUERY\",\"SchemaName\":null,\"TableName\":null,\"ColumnName\":null,\"DataTypeName\":null,\"ConstraintName\":null,\"File\":\"pl_exec.c\",\"Line\":\"3178\",\"Routine\":\"exec_stmt_raise\"},\"ExceptionText\":null,\"ControllerName\":\"CardsField\",\"ActionName\":\"GetFields\",\"HttpRequest\":{\"query\":\"http://10.1.12.204/CardsField/GetFields\",\"method\":\"POST\",\"requestBody\":\"{\\\"cardCode\\\":\\\"054-001-655\\\",\\\"cardType\\\":\\\"investprojectco\\\",\\\"versionId\\\":\\\"0\\\"}\"},\"StatusCode\":500,\"HttpResponse\":\"Уважаемый пользователь, на сервере возникла ошибка, обратитесь, пожалуйста, в службу технической поддержки. [Код ошибки:0HMJET0PUHD3T:00000003]\",\"UserName\":null,\"HostName\":null,\"LogLevel\":\"WebApi.Info\",\"DurationMilliseconds\":72,\"CreateDateTime\":\"2022-07-26T14:43:55.5337689+03:00\",\"RequestId\":\"0HMJET0PUHD3T:00000003\"}ErrorMessage:Npgsql.PostgresException (0x80004005): P0001: Сотрудник 0 не найден",
    "input": {
      "type": "log"
    },
    "agent": {
      "ephemeral_id": "762132cd-d5f9-49b9-94b7-4fb7827ca898",
      "id": "20871cb5-e97f-4208-b299-8c2366e05d84",
      "name": "rosatomtest",
      "type": "filebeat",
      "version": "7.12.0",
      "hostname": "rosatomtest"
    },
    "ecs": {
      "version": "1.8.0"
    },
    "host": {
      "ip": [
        "10.1.12.204",
        "fe80::d5a3:d79b:f015:d523"
      ],
      "mac": [
        "00:15:5d:46:05:9d"
      ],
      "hostname": "rosatomtest",
      "architecture": "x86_64",
      "os": {
        "family": "",
        "name": "Astra Linux (Smolensk)",
        "kernel": "4.15.3-1-generic",
        "codename": "smolensk",
        "type": "linux",
        "platform": "astra",
        "version": ""
      },
      "id": "e8912a7364c54ef7bf15f20a5c2e8ce1",
      "name": "rosatomtest",
      "containerized": false
    }
  },
  "fields": {
    "@timestamp": [
      "2022-07-26T11:43:55.759Z"
    ]
  },
  "highlight": {
    "message": [
      "{\"ExceptionReceived\":{\"ClassName\":\"Npgsql.PostgresException\",\"Message\":\"P0001: Сотрудник 0 не найден\",\"Data\":{\"Severity\":\"ОШИБКА\",\"InvariantSeverity\":\"@kibana-highlighted-field@ERROR@/kibana-highlighted-field@\",\"SqlState\":\"P0001\",\"MessageText\":\"Сотрудник 0 не найден\",\"Hint\":\"Вероятно пользователь не зарегистрирован в системе\",\"Where\":\"функция PL/pgSQL cards_system.getaccesswithprofilefromcache(integer,bigint,integer,character varying,integer,character varying,character varying,boolean), строка 9, оператор RAISE\\nфункция PL/pgSQL cards_system.getaccesswithprofilebysysname(character varying,bigint,character varying,character varying,integer,character varying,character varying,boolean), строка 71, оператор RETURN QUERY\",\"File\":\"pl_exec.c\",\"Line\":\"3178\",\"Routine\":\"exec_stmt_raise\"},\"InnerException\":null,\"HelpURL\":null,\"StackTraceString\":\"   at Npgsql.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|194_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\\n   at Npgsql.NpgsqlDataReader.<>c__DisplayClass41_0.<<ReadMessage>g__ReadMessageSequential|0>d.MoveNext()\\n--- End of stack trace from previous location where exception was thrown ---\\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\\n   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 418\\n   at PMPractice.Cards.Access.Repository.CardsAccessRepositoryPostgreSql.GetAccessWithProfileBySysNameAsync(Int64 userId, String cardType, String cardCode, Nullable`1 stateId, String elementType, IEnumerable`1 elementsId, String profileInputFields, Boolean noProfile) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/InformationSecurityTools/src/PMPractice.Cards.Access/Repository/CardsAccessReposutoryPostgreSql.cs:line 77\\n   at PMPractice.Cards.Access.Repository.CardsAccessControl.GetAccessWithProfileBySysNameAsync(GetAccessWithProfileBySysNameParams accessRequest) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/InformationSecurityTools/src/PMPractice.Cards.Access/Repository/CardsAccessControl.cs:line 105\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetAccess(String cardCode, String cardType, Int32 stateId, Int32 versionId, String userAccount) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 829\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetFieldsAsync(GetFieldsArgs args, String userAccount, Boolean isSaveCard, Boolean useAccess) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 323\\n   at PMPractice.Cards.Service.Fields.FieldsService.GetFieldsAsync(GetFieldsArgs args, String userAccount, Boolean isSaveCard, Boolean useAccess) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Service/Fields/FieldsService.cs:line 466\\n   at PMPractice.Cards.Controllers.FieldController.CardsFieldController.GetFieldsAsync(GetFieldsArgs args) in /opt/TeamCity/buildAgent/work/31d0eb3229f98524/Backend.Core/PMPractice.Cards.Controllers/FieldController/CardsFieldController.cs:line 46\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\",\"RemoteStackTraceString\":null,\"RemoteStackIndex\":0,\"ExceptionMethod\":null,\"HResult\":-2147467259,\"Source\":\"Npgsql\",\"WatsonBuckets\":null,\"Severity\":\"ОШИБКА\",\"InvariantSeverity\":\"@kibana-highlighted-field@ERROR@/kibana-highlighted-field@\",\"SqlState\":\"P0001\",\"MessageText\":\"Сотрудник 0 не найден\",\"Detail\":null,\"Hint\":\"Вероятно пользователь не зарегистрирован в системе\",\"Position\":0,\"InternalPosition\":0,\"InternalQuery\":null,\"Where\":\"функция PL/pgSQL cards_system.getaccesswithprofilefromcache(integer,bigint,integer,character varying,integer,character varying,character varying,boolean), строка 9, оператор RAISE\\nфункция PL/pgSQL cards_system.getaccesswithprofilebysysname(character varying,bigint,character varying,character varying,integer,character varying,character varying,boolean), строка 71, оператор RETURN QUERY\",\"SchemaName\":null,\"TableName\":null,\"ColumnName\":null,\"DataTypeName\":null,\"ConstraintName\":null,\"File\":\"pl_exec.c\",\"Line\":\"3178\",\"Routine\":\"exec_stmt_raise\"},\"ExceptionText\":null,\"ControllerName\":\"CardsField\",\"ActionName\":\"GetFields\",\"HttpRequest\":{\"query\":\"http://10.1.12.204/CardsField/GetFields\",\"method\":\"POST\",\"requestBody\":\"{\\\"cardCode\\\":\\\"054-001-655\\\",\\\"cardType\\\":\\\"investprojectco\\\",\\\"versionId\\\":\\\"0\\\"}\"},\"StatusCode\":500,\"HttpResponse\":\"Уважаемый пользователь, на сервере возникла ошибка, обратитесь, пожалуйста, в службу технической поддержки. [Код ошибки:0HMJET0PUHD3T:00000003]\",\"UserName\":null,\"HostName\":null,\"LogLevel\":\"WebApi.Info\",\"DurationMilliseconds\":72,\"CreateDateTime\":\"2022-07-26T14:43:55.5337689+03:00\",\"RequestId\":\"0HMJET0PUHD3T:00000003\"}ErrorMessage:Npgsql.PostgresException (0x80004005): P0001: Сотрудник 0 не найден"
    ]
  },
  "sort": [
    1658835835759
  ]
}